#include "LedCube.h"

/*
 * Connect the CS pin (5) to the clock pin of the shift register
 * Connect the SCK pin (18) to the latch pin of the shift register
 * Connect the MOSI pin (23) to the data pin of the shift register
 */


unsigned long previousMillis = 0;
const long interval = 250;
int frame = 0;

LedCube Cube(5, CtrlFIRST);

// Format [Frame][Plate][Row]
byte leds[9][8][8] = {
  {
  {255,255,255,255,255,255,255,255},
  {127,127,127,127,127,127,127,127},
  {63,63,63,63,63,63,63,63},
  {31,31,31,31,31,31,31,31},
  {15,15,15,15,15,15,15,15},
  {7,7,7,7,7,7,7,7},
  {3,3,3,3,3,3,3,3},
  {1,1,1,1,1,1,1,1}},
  {
    {1,1,1,1,1,1,1,1},
  {255,255,255,255,255,255,255,255},
  {127,127,127,127,127,127,127,127},
  {63,63,63,63,63,63,63,63},
  {31,31,31,31,31,31,31,31},
  {15,15,15,15,15,15,15,15},
  {7,7,7,7,7,7,7,7},
  {3,3,3,3,3,3,3,3}},
  {
    {3,3,3,3,3,3,3,3},
  {1,1,1,1,1,1,1,1},
  {255,255,255,255,255,255,255,255},
  {127,127,127,127,127,127,127,127},
  {63,63,63,63,63,63,63,63},
  {31,31,31,31,31,31,31,31},
  {15,15,15,15,15,15,15,15},
  {7,7,7,7,7,7,7,7}},
  {
    {7,7,7,7,7,7,7,7},
  {3,3,3,3,3,3,3,3},
  {1,1,1,1,1,1,1,1},
  {255,255,255,255,255,255,255,255},
  {127,127,127,127,127,127,127,127},
  {63,63,63,63,63,63,63,63},
  {31,31,31,31,31,31,31,31},
  {15,15,15,15,15,15,15,15}},
  {
    {15,15,15,15,15,15,15,15},
  {7,7,7,7,7,7,7,7},
  {3,3,3,3,3,3,3,3},
  {1,1,1,1,1,1,1,1},
  {255,255,255,255,255,255,255,255},
  {127,127,127,127,127,127,127,127},
  {63,63,63,63,63,63,63,63},
  {31,31,31,31,31,31,31,31}},
  {
    {31,31,31,31,31,31,31,31},
  {15,15,15,15,15,15,15,15},
  {7,7,7,7,7,7,7,7},
  {3,3,3,3,3,3,3,3},
  {1,1,1,1,1,1,1,1},
  {255,255,255,255,255,255,255,255},
  {127,127,127,127,127,127,127,127},
  {63,63,63,63,63,63,63,63}},
  {
    {63,63,63,63,63,63,63,63},
  {31,31,31,31,31,31,31,31},
  {15,15,15,15,15,15,15,15},
  {7,7,7,7,7,7,7,7},
  {3,3,3,3,3,3,3,3},
  {1,1,1,1,1,1,1,1},
  {255,255,255,255,255,255,255,255},
  {127,127,127,127,127,127,127,127}},
  {
    {127,127,127,127,127,127,127,127},
  {63,63,63,63,63,63,63,63},
  {31,31,31,31,31,31,31,31},
  {15,15,15,15,15,15,15,15},
  {7,7,7,7,7,7,7,7},
  {3,3,3,3,3,3,3,3},
  {1,1,1,1,1,1,1,1},
  {255,255,255,255,255,255,255,255}},
  {
    {255,255,255,255,255,255,255,255},
  {127,127,127,127,127,127,127,127},
  {63,63,63,63,63,63,63,63},
  {31,31,31,31,31,31,31,31},
  {15,15,15,15,15,15,15,15},
  {7,7,7,7,7,7,7,7},
  {3,3,3,3,3,3,3,3},
  {1,1,1,1,1,1,1,1}}};

byte clear[8][8] = {{1,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0}};


void setup() 
{

}

void loop() 
{
  unsigned long currentMillis = millis();
  if (currentMillis - previousMillis >= interval)
  {
    previousMillis = currentMillis;
    frame++;
    if(frame==8){
      frame=0;
    }
  }
  Cube.show(clear);
}
/*
void showCube(int mFrame){
  for (int layer = 0; layer < 8; layer++){
    for (int j = 0; j < 8; j++){
      digitalWrite(layers[j], LOW);
    }
    digitalWrite(layers[layer], HIGH);
    updateShiftRegister(leds[mFrame][layer]);
  }
}*/

/*
 * updateShiftRegister() - This function sets the latchPin to low, then calls the Arduino function 'shiftOut' to shift out contents of variable 'leds' in the shift register before putting the 'latchPin' high again.
 */

/*
void updateShiftRegister(byte shiftLeds[8])
{
  digitalWrite(SS, LOW);
  for (int i = 0; i < 8; i++)
  {
    SPI.transfer(shiftLeds[i]);
  }
  digitalWrite(SS, HIGH);
}
*/